## Классификация данных и меры защиты

| **Данные** | **Необходимость защиты** | **Инструменты защиты** |
|-------------|--------------------------|--------------------------|
| **Персональные данные пациентов (PII)** — ФИО, дата рождения, контакты, адрес, паспортные данные | Высокая чувствительность, подпадает под ФЗ-152 и GDPR. Риск несанкционированного доступа, утечки и мошенничества. |  **At rest:** Шифрование AES-256 в S3 (SSE-KMS); шифрование в PostgreSQL на уровне столбцов. Envelope-шифрование  с ротацией ключей через KMS <br> **In transit:** TLS 1.3; HTTPS с HSTS.<br> **Контроль:** IAM роли; деидентификация (NER + MASK + MIN).<br> **Мониторинг:** Cloud Logging + аудит доступа. |
| **Медицинские данные (MED)** — диагнозы, назначения, результаты анализов | Наиболее чувствительные категории; регламентированы 152-ФЗ и ГОСТ Р 57580.1-2017. Угроза репутационным и юридическим рискам. |  **At rest:** Шифрование AES-256 (SSE-KMS), доступ только через Privacy Gate.<br> **In transit:** TLS/VPN (через GOST Gateway).<br> **Контроль:** роль-based доступ (RBAC/OAuth2), псевдонимизация patient_id, контроль изоляции в Airflow DAG.<br> **Мониторинг:** аудит загрузок и обращений к данным (Cloud Logging). |
| **Платёжные данные (PAY)** — PAN, сумма, реквизиты, СНИЛС | Финансовая информация, требуется соблюдение PCI DSS и ФЗ-161. |  **At rest:** токенизация реквизитов в Lockbox, шифрование в PostgreSQL.<br> **In transit:** TLS, шифрование почтовых вложений.<br> **Контроль:** маскирование PAN, токен-ID при интеграциях.<br> **Мониторинг:** журналирование платёжных операций и сверок (Cloud Logging + 1С Audit). |
| **Документы и сканы (DOC)** — договоры, паспорта, согласия | Содержат персональные и юридические сведения; риск утечек при ручной обработке. |  **At rest:** шифрование при заливке в S3 (SSE-KMS), ограниченный ACL.<br> **In transit:** TLS; presigned URL через Yandex S3 библиотеку.<br> **Контроль:** обфускация имён файлов, контроль доступа IAM.<br> **Мониторинг:** Cloud Logging событий загрузки и скачивания. |
| **Внутренние служебные данные (INT)** — пользователи, конфигурации, ключи | Потенциальный источник компрометации всей инфраструктуры. |  **At rest:** хранение секретов в Lockbox, ключей в KMS.<br> **In transit:** TLS внутри VPC.<br> **Контроль:** MFA в IAM, принцип наименьших прав.<br> **Мониторинг:** Cloud Audit Logs, оповещения по аномалиям. |
| **Публичные данные (PUB)** — уведомления, шаблоны писем без PII | Риск низкий, но возможно случайное раскрытие. |  **In transit:** TLS (почта/веб).<br> **Контроль:** валидация контента перед отправкой (Деидентификация check).<br> **Мониторинг:** выборочная проверка контента и логирование отправлений. |
| **Метаданные и технические логи** | Могут содержать PII при ошибках логирования. |  **Контроль:** обфускация/маскирование PII в логах.<br> **At rest:** шифрование Cloud Logging.<br> **Мониторинг:** автоматическая проверка PII-детектом (NER pipeline). |
| **Данные аналитических витрин (Золотые, Обработанные)** | Производные от PII/MED, но всё ещё чувствительные при малых выборках. |  **Контроль:** Privacy Gate, доступ только через SSO.<br> **At rest:** шифрование в ClickHouse.<br> **Мониторинг:** аудит запросов/маломощных групп. |
| **Синтетические данные (Dev/QA)** | Используются для тестов, не должны содержать реальные PII. |  **Контроль:** генерация синтетики (обезличенные данные), проверка Деидентификация.<br> **Мониторинг:** контроль за non-production средами (Cloud Logging). |

---

## Реестр программных и аппаратных средств защиты данных

| **Категория** | **Средства** | **Назначение / Комментарий** |
|----------------|--------------|-------------------------------|
| **Шифрование at rest** |  Yandex KMS (AES-256) + Envelope шифрование (DEK на уровне строки/столбца, KEK в KMS),  PostgreSQL TDE / pgcrypto | Защита данных в хранилищах (S3, DB, ClickHouse). |
| **Шифрование in transit** |  TLS 1.3,  HTTPS,  VPN (через GOST Gateway) | Защита при передаче данных (API, Mail, Lab GW). |
| **Токенизация / маскирование** |  Yandex Lockbox,  Деидентификация Pipeline (MASK, TOK) | Сокрытие PII/PAY в логах, отчётах и интеграциях. |
| **Контроль доступа** |  IAM (Yandex OAuth2/SSO),  RBAC | Разделение ролей (User, Staff, Analyst, Admin). |
| **Аудит и мониторинг** |  Cloud Logging,  Cloud Monitoring | Централизованный аудит DAG, загрузок, доступов. |
| **Анонимизация / Деидентификация** |  NER (Natasha, DeepPavlov),  регулярные выражения | Определение PII, обфускация перед загрузкой. |
| **Управление жизненным циклом данных** |  S3 Lifecycle,  Airflow DAG retention | Автоудаление/архивация по сроку хранения. |
| **Безопасная разработка / инфраструктура** |  MFA,  Zero Trust Network,  Secret Scanning в CI/CD | Исключение утечек ключей и конфигураций. |

---

## Принципы защиты данных по состоянию

| **Состояние данных** | **Угрозы** | **Меры защиты** |
|-----------------------|------------|------------------|
| **При хранении (At rest)** | Несанкционированный доступ, кража, компрометация дисков | Шифрование AES-256 (SSE-KMS), токенизация, ACL, ротация ключей. |
| **В передаче (In transit)** | Перехват, MITM, подмена данных | TLS 1.3, VPN (GOST Gateway), HSTS, временные токены доступа. |
| **В обработке (In use)** | Ошибки доступа, логирование PII, инсайдерские угрозы | Одноразовые объекты в коде, Privacy Gate, RBAC/OAuth2, маскирование в логах, Деидентификация при ETL. |
| **В утилизации (Disposal)** | Утечка при удалении/архивации | Автоудаление (S3 Lifecycle), шифрованное архивирование, отчёт об уничтожении. |
